import {
  APIProvider,
  InfoWindow,
  Map,
  Marker,
  useMap
  // ,
  // AdvancedMarker
} from "@vis.gl/react-google-maps";
import { useWebSocketData } from "../../containers/getGemsDataWebsocket/getGemsWebsocket";
import { useCallback, useMemo, useState, useEffect } from "react";
import React from "react";
import useUserLocation from "../../containers/userLocation/getUserLocation";
import StationMarker from "./stationmarker";

const MAPID = import.meta.env.VITE_MAPID || "";
const MAPAPIKEY = import.meta.env.VITE_GOOGLE_MAPS_API_KEY || "";
const busIcon = "/Bus.svg";
const userIcon = "/userIcon.png";


console.log(MAPAPIKEY);
interface TrackerData {
  server_time: string;
  tracker_time: string;
  direction: number;
  position: string;
  speed: number;
}

export interface WebSocketMessage {
  status: string;
  data: {
    [key: string]: TrackerData;
  };
}

interface SelectedMarker {
  key: string;
  value: TrackerData;
}

const MapComponant: React.FC<{
  selectedRoute?: string | null;
}> = ({selectedRoute}) => {
  // set center
  const [center, setCenter] = useState({
    lat: 20.045116568504863,
    lng: 99.89429994369891,
  });

  ///////////// test polyline component ///////////////////////
  const PolylineComponent: React.FC<{ path: google.maps.LatLngLiteral[], color: string }> = ({ path, color }) => {
    const map = useMap();
    
    useEffect(() => {
      if (map && window.google) {
        const polyline = new window.google.maps.Polyline({
          path: path,
          geodesic: true,
          strokeColor: color,
          strokeOpacity: 1.0,
          strokeWeight: 2
        });
        
        polyline.setMap(map);
        
        return () => {
          polyline.setMap(null);
        };
      }
    }, [map, path, color]);
  
    return null;
  };
  //////////////////////////////////////////////////////////////

  // รับข้อมูลจาก websocket  ================================================
  const { messages } = useWebSocketData() as {
    messages: WebSocketMessage | null;
  };
  const data = useMemo(() => {
    return messages && messages.status === "ok" ? messages.data : null;
  }, [messages]);

  ////////// test polyline state ///////////////////////
  const [polylinePath, setPolylinePath] = useState<google.maps.LatLngLiteral[]>([]);
  //////////////////////////////////////////////////////

  
  // ตำแหน่งของผู้ใช้งาน  ================================================
  const [isOpen, setIsOpen] = useState(false);
  const location = useUserLocation();
  const userMarker = useMemo(() => {
    if (location && location.lat && location.lng && window.google && window.google.maps) {
      return (
        <>
          <Marker
            key="user-location"
            position={{ lat: location.lat, lng: location.lng }}
            title="Your Location"
            onClick={() =>{ setIsOpen(true);
              
            }}
            icon={{
              url: userIcon,
              scaledSize: window.google.maps.Size ? new window.google.maps.Size(22, 20) : null,
              origin: window.google.maps.Point ? new window.google.maps.Point(0, 0) : null,
              anchor: window.google.maps.Point ? new window.google.maps.Point(11, 10) : null,
            }}
          />
          {isOpen && (
            <InfoWindow
              position={{ lat: location.lat, lng: location.lng }}
              onCloseClick={() => setIsOpen(false)}
              headerContent={`คุณอยู่ตรงนี้`}
            >
            </InfoWindow>
          )}
        </>
      );
    }
    return null;
  }, [location, isOpen]);



  // markers รถเจม ==================================================================================================
  // เซ็ท marker ที่เลือก
  const [selectedMarker, setSelectedMarker] = useState<SelectedMarker | null>(
    null
  );

  // handle คลิก markers
  const handleMarkerClick = useCallback((key: string, value: TrackerData) => {
    const [lat, lng] = value.position.split(",").map(Number);
    console.log(`Marker ${key} clicked`, value);
    setSelectedMarker({ key, value });
    setCenter({ lat, lng });
  }, []);

  // handle ปิด infowindow
  const handleInfoWindowClose = useCallback(() => {
    setSelectedMarker(null);
  }, []);

  ////////////// test polyline path ///////////////////////
  ////////////// test polyline path ///////////////////////
  const updatePolylinePath = useCallback((route: string) => {
    if (route === "route1") {
      setPolylinePath([
        { lng: 99.8997827, lat: 20.0589569 },
        { lng: 99.8997827, lat: 20.0589569 },
        { lng: 99.8996909, lat: 20.0589582 },
        { lng: 99.8996017, lat: 20.058957 },
        { lng: 99.8993425, lat: 20.0589355 },
        { lng: 99.8992499, lat: 20.0589232 },
        { lng: 99.8991599, lat: 20.0589009 },
        { lng: 99.8989157, lat: 20.0588259 },
        { lng: 99.898817, lat: 20.058791 },
        { lng: 99.8987211, lat: 20.0587484 },
        { lng: 99.8986305, lat: 20.0586996 },
        { lng: 99.8985238, lat: 20.0586256 },
        { lng: 99.8983486, lat: 20.0584751 },
        { lng: 99.8981761, lat: 20.058322 },
        { lng: 99.8979867, lat: 20.0581434 },
        { lng: 99.8978173, lat: 20.0579623 },
        { lng: 99.8976534, lat: 20.0577674 },
        { lng: 99.8975002, lat: 20.0575624 },
        { lng: 99.897016, lat: 20.0567347 },
        { lng: 99.8967415, lat: 20.0568365 },
        { lng: 99.8966989, lat: 20.056765 },
        { lng: 99.8966574, lat: 20.0566951 },
        { lng: 99.8966268, lat: 20.0566422 },
        { lng: 99.8965966, lat: 20.0565872 },
        { lng: 99.8965756, lat: 20.0565426 },
        { lng: 99.8965552, lat: 20.056496 },
        { lng: 99.8964896, lat: 20.0563382 },
        { lng: 99.8964775, lat: 20.0562761 },
        { lng: 99.8964694, lat: 20.0562447 },
        { lng: 99.8964639, lat: 20.0562133 },
        { lng: 99.8964554, lat: 20.0561392 },
        { lng: 99.8964495, lat: 20.0560645 },
        { lng: 99.8964396, lat: 20.0559607 },
        { lng: 99.8964328, lat: 20.0558569 },
        { lng: 99.8964288, lat: 20.0557519 },
        { lng: 99.8964208, lat: 20.0556463 },
        { lng: 99.8964159, lat: 20.0555742 },
        { lng: 99.8963948, lat: 20.0554879 },
        { lng: 99.8963746, lat: 20.0554032 },
        { lng: 99.8963608, lat: 20.055355 },
        { lng: 99.8963326, lat: 20.0552875 },
        { lng: 99.8962873, lat: 20.0552151 },
        { lng: 99.8962524, lat: 20.0551765 },
        { lng: 99.8962275, lat: 20.05516 },
        { lng: 99.8961789, lat: 20.0551241 },
        { lng: 99.8960826, lat: 20.0550769 },
        { lng: 99.8959928, lat: 20.0550567 },
        { lng: 99.8958915, lat: 20.0550564 },
        { lng: 99.8957353, lat: 20.0550657 },
        { lng: 99.8956552, lat: 20.0550735 },
        { lng: 99.895573, lat: 20.0550781 },
        { lng: 99.8954516, lat: 20.0550666 },
        { lng: 99.8953735, lat: 20.0550564 },
        { lng: 99.8953296, lat: 20.0550507 },
        { lng: 99.8952651, lat: 20.0550312 },
        { lng: 99.8952005, lat: 20.0550091 },
        { lng: 99.895136, lat: 20.0549871 },
        { lng: 99.8950741, lat: 20.0549606 },
        { lng: 99.8950101, lat: 20.054934 },
        { lng: 99.8949481, lat: 20.0549065 },
        { lng: 99.8948652, lat: 20.0548679 },
        { lng: 99.8947932, lat: 20.054836 },
        { lng: 99.8945746, lat: 20.0547501 },
        { lng: 99.8945201, lat: 20.0547274 },
        { lng: 99.8944639, lat: 20.0547041 },
        { lng: 99.8943543, lat: 20.0546603 },
        { lng: 99.8942609, lat: 20.0546337 },
        { lng: 99.8941628, lat: 20.0546082 },
        { lng: 99.8939414, lat: 20.0545464 },
        { lng: 99.8937535, lat: 20.0544771 },
        { lng: 99.8936058, lat: 20.0544036 },
        { lng: 99.8934594, lat: 20.0543244 },
        { lng: 99.8933622, lat: 20.054254 },
        { lng: 99.8932663, lat: 20.0541843 },
        { lng: 99.8931002, lat: 20.054071 },
        { lng: 99.8930004, lat: 20.0539791 },
        { lng: 99.8928909, lat: 20.0538712 },
        { lng: 99.8928392, lat: 20.0538175 },
        { lng: 99.8928053, lat: 20.0537847 },
        { lng: 99.8927505, lat: 20.0537012 },
        { lng: 99.8926973, lat: 20.0536165 },
        { lng: 99.892581, lat: 20.0533984 },
        { lng: 99.8925537, lat: 20.0533455 },
        { lng: 99.8925256, lat: 20.0532655 },
        { lng: 99.8924896, lat: 20.0531458 },
        { lng: 99.8924186, lat: 20.0529044 },
        { lng: 99.8924002, lat: 20.0528449 },
        { lng: 99.8923844, lat: 20.0527835 },
        { lng: 99.892367, lat: 20.052722 },
        { lng: 99.8923556, lat: 20.0526809 },
        { lng: 99.8922973, lat: 20.0525432 },
        { lng: 99.8922661, lat: 20.0524731 },
        { lng: 99.8922423, lat: 20.0524128 },
        { lng: 99.8921971, lat: 20.0523306 },
        { lng: 99.8921459, lat: 20.0522484 },
        { lng: 99.8920397, lat: 20.0521195 },
        { lng: 99.891986, lat: 20.0520554 },
        { lng: 99.8919154, lat: 20.0519718 },
        { lng: 99.891755, lat: 20.0517808 },
        { lng: 99.8916748, lat: 20.0516856 },
        { lng: 99.8915859, lat: 20.0515781 },
        { lng: 99.8913536, lat: 20.0511703 },
        { lng: 99.8912703, lat: 20.0510214 },
        { lng: 99.8912337, lat: 20.0509441 },
        { lng: 99.8911985, lat: 20.0508656 },
        { lng: 99.8911801, lat: 20.0508243 },
        { lng: 99.8911678, lat: 20.0507811 },
        { lng: 99.8911437, lat: 20.0506959 },
        { lng: 99.8911174, lat: 20.0506111 },
        { lng: 99.8910944, lat: 20.050526 },
        { lng: 99.8910882, lat: 20.0504197 },
        { lng: 99.8910874, lat: 20.0503141 },
        { lng: 99.8910858, lat: 20.0501086 },
        { lng: 99.8910846, lat: 20.0499018 },
        { lng: 99.891089, lat: 20.0498053 },
        { lng: 99.8911041, lat: 20.049695 },
        { lng: 99.8911119, lat: 20.0496038 },
        { lng: 99.8911355, lat: 20.04949 },
        { lng: 99.8911608, lat: 20.0493906 },
        { lng: 99.8911871, lat: 20.0492912 },
        { lng: 99.8912209, lat: 20.0491683 },
        { lng: 99.8912763, lat: 20.0490323 },
        { lng: 99.8913104, lat: 20.048963 },
        { lng: 99.8913385, lat: 20.0489091 },
        { lng: 99.8913592, lat: 20.0488773 },
        { lng: 99.8914365, lat: 20.0488873 },
        { lng: 99.8914971, lat: 20.0488828 },
        { lng: 99.8916249, lat: 20.0488335 },
        { lng: 99.8917959, lat: 20.0487638 },
        { lng: 99.8922514, lat: 20.0485589 },
        { lng: 99.8926419, lat: 20.0483837 },
        { lng: 99.8929467, lat: 20.0482459 },
        { lng: 99.8930229, lat: 20.0482148 },
        { lng: 99.8930589, lat: 20.0482013 },
        { lng: 99.8931777, lat: 20.048174 },
        { lng: 99.8932891, lat: 20.0481476 },
        { lng: 99.8932677, lat: 20.0480829 },
        { lng: 99.8931389, lat: 20.0479292 },
        { lng: 99.8929921, lat: 20.0480069 },
        { lng: 99.8929512, lat: 20.0478615 },
        { lng: 99.8931788, lat: 20.0474814 },
        { lng: 99.8931785, lat: 20.0472272 },
        { lng: 99.8930518, lat: 20.0472262 },
        { lng: 99.8929715, lat: 20.0474812 },
        { lng: 99.8929353, lat: 20.0478682 },
        { lng: 99.8929743, lat: 20.0480159 },
        { lng: 99.8929922, lat: 20.0481098 },
        { lng: 99.8930102, lat: 20.0482024 },
        { lng: 99.8929819, lat: 20.0482137 },
        { lng: 99.892933, lat: 20.0482347 },
        { lng: 99.8926391, lat: 20.0483744 },
        { lng: 99.892213, lat: 20.0485651 },
        { lng: 99.8917927, lat: 20.0487557 },
        { lng: 99.8916221, lat: 20.0488252 },
        { lng: 99.8914955, lat: 20.0488731 },
        { lng: 99.8914366, lat: 20.0488779 },
        { lng: 99.8913636, lat: 20.0488701 },
        { lng: 99.8915104, lat: 20.0486333 },
        { lng: 99.8915811, lat: 20.0485134 },
        { lng: 99.8916163, lat: 20.0484535 },
        { lng: 99.8916736, lat: 20.0483635 },
        { lng: 99.891708, lat: 20.0483201 },
        { lng: 99.8917428, lat: 20.048277 },
        { lng: 99.8918363, lat: 20.0481713 },
        { lng: 99.8919394, lat: 20.0480538 },
        { lng: 99.8920016, lat: 20.0479813 },
        { lng: 99.8920593, lat: 20.0478905 },
        { lng: 99.8920854, lat: 20.0478402 },
        { lng: 99.8921119, lat: 20.0477889 },
        { lng: 99.8921574, lat: 20.0476307 },
        { lng: 99.8921777, lat: 20.0475088 },
        { lng: 99.8921846, lat: 20.0474087 },
        { lng: 99.8921947, lat: 20.0473112 },
        { lng: 99.8921699, lat: 20.0470603 },
        { lng: 99.8921076, lat: 20.0468359 },
        { lng: 99.8920648, lat: 20.0467406 },
        { lng: 99.8920038, lat: 20.0466459 },
        { lng: 99.8919145, lat: 20.0464944 },
        { lng: 99.8917914, lat: 20.0462317 },
        { lng: 99.8917192, lat: 20.0460748 },
        { lng: 99.8916797, lat: 20.0459942 },
        { lng: 99.8916315, lat: 20.0459148 },
        { lng: 99.8915592, lat: 20.0457743 },
        { lng: 99.8914856, lat: 20.0456344 },
        { lng: 99.8914141, lat: 20.0454988 },
        { lng: 99.8913877, lat: 20.045449 },
        { lng: 99.8913307, lat: 20.0453126 },
        { lng: 99.8913154, lat: 20.0452136 },
        { lng: 99.8913095, lat: 20.0451397 },
        { lng: 99.8913039, lat: 20.0449122 },
        { lng: 99.8913119, lat: 20.0447601 },
        { lng: 99.8913452, lat: 20.0445943 },
        { lng: 99.891434, lat: 20.0444026 },
        { lng: 99.8915132, lat: 20.0442342 },
        { lng: 99.8916175, lat: 20.0442243 },
        { lng: 99.8918259, lat: 20.0442228 },
        { lng: 99.89196, lat: 20.0442208 },
        { lng: 99.8920337, lat: 20.0442203 },
        { lng: 99.8926272, lat: 20.0441321 },
        { lng: 99.8928554, lat: 20.0441132 },
        { lng: 99.8928826, lat: 20.0441098 },
        { lng: 99.8929816, lat: 20.0440912 },
        { lng: 99.8930463, lat: 20.0440683 },
        { lng: 99.8932048, lat: 20.043997 },
        { lng: 99.8934262, lat: 20.0438959 },
        { lng: 99.8938276, lat: 20.043718 },
        { lng: 99.8939553, lat: 20.0436854 },
        { lng: 99.8940488, lat: 20.0436731 },
        { lng: 99.894098, lat: 20.0436697 },
        { lng: 99.8942078, lat: 20.0436613 },
        { lng: 99.8942996, lat: 20.0436659 },
        { lng: 99.8944575, lat: 20.043698 },
        { lng: 99.8945951, lat: 20.0437399 },
        { lng: 99.8947716, lat: 20.0438333 },
        { lng: 99.8948917, lat: 20.0438845 },
        { lng: 99.8950714, lat: 20.0439147 },
        { lng: 99.8953155, lat: 20.0439097 },
        { lng: 99.895457, lat: 20.043875 },
        { lng: 99.8956119, lat: 20.0438139 },
        { lng: 99.8957742, lat: 20.0437056 },
        { lng: 99.8958459, lat: 20.0436256 },
        { lng: 99.8959804, lat: 20.0435396 },
        { lng: 99.8961175, lat: 20.0434757 },
        { lng: 99.8961789, lat: 20.0434584 },
        { lng: 99.8962389, lat: 20.0434593 },
        { lng: 99.8963304, lat: 20.0434956 },
        { lng: 99.8963951, lat: 20.0435545 },
        { lng: 99.8964508, lat: 20.0435274 },
        { lng: 99.8965611, lat: 20.0434244 },
        { lng: 99.8966297, lat: 20.0433452 },
        { lng: 99.8966475, lat: 20.0432867 },
        { lng: 99.8966627, lat: 20.0432004 },
        { lng: 99.8966429, lat: 20.0431047 },
        { lng: 99.8965981, lat: 20.0430196 },
        { lng: 99.8965172, lat: 20.0429812 },
        { lng: 99.8963929, lat: 20.0429582 },
        { lng: 99.8962633, lat: 20.0429591 },
        { lng: 99.8960632, lat: 20.0429837 },
        { lng: 99.8957219, lat: 20.0430883 },
        { lng: 99.8955113, lat: 20.0431859 },
        { lng: 99.8952759, lat: 20.0433418 },
        { lng: 99.895051, lat: 20.0434399 },
        { lng: 99.8949686, lat: 20.0434291 },
        { lng: 99.8949047, lat: 20.0433923 },
        { lng: 99.8948374, lat: 20.0434379 },
        { lng: 99.8945102, lat: 20.0435459 },
        { lng: 99.8943687, lat: 20.0435716 },
        { lng: 99.8942758, lat: 20.0436077 },
        { lng: 99.8942091, lat: 20.0436495 },
        { lng: 99.8941124, lat: 20.0436551 },
        { lng: 99.8940131, lat: 20.0436631 },
        { lng: 99.8939117, lat: 20.0436807 },
        { lng: 99.8938177, lat: 20.0437089 },
        { lng: 99.8930414, lat: 20.0440568 },
        { lng: 99.8929796, lat: 20.0440777 },
        { lng: 99.8929168, lat: 20.0440911 },
        { lng: 99.8928541, lat: 20.0440994 },
        { lng: 99.8926231, lat: 20.0441198 },
        { lng: 99.892329, lat: 20.0441641 },
        { lng: 99.8920343, lat: 20.0442088 },
        { lng: 99.8918253, lat: 20.0442095 },
        { lng: 99.8916178, lat: 20.0442108 },
        { lng: 99.8915146, lat: 20.0442241 },
        { lng: 99.891451, lat: 20.044209 },
        { lng: 99.8913807, lat: 20.0441894 },
        { lng: 99.8912265, lat: 20.0445567 },
        { lng: 99.8911876, lat: 20.0447384 },
        { lng: 99.8911775, lat: 20.0449781 },
        { lng: 99.8911848, lat: 20.0450994 },
        { lng: 99.8912321, lat: 20.0452949 },
        { lng: 99.8912766, lat: 20.0454387 },
        { lng: 99.8913206, lat: 20.0455681 },
        { lng: 99.8913485, lat: 20.0456496 },
        { lng: 99.8913868, lat: 20.045732 },
        { lng: 99.8914998, lat: 20.0459649 },
        { lng: 99.8916081, lat: 20.046094 },
        { lng: 99.8917168, lat: 20.0462329 },
        { lng: 99.8919067, lat: 20.0464981 },
        { lng: 99.8920563, lat: 20.0467426 },
        { lng: 99.8920671, lat: 20.0467636 },
        { lng: 99.8920998, lat: 20.0468378 },
        { lng: 99.8921615, lat: 20.0470613 },
        { lng: 99.892184, lat: 20.047312 },
        { lng: 99.8921742, lat: 20.0474083 },
        { lng: 99.8921667, lat: 20.0475086 },
        { lng: 99.8921464, lat: 20.0476294 },
        { lng: 99.8921051, lat: 20.0477859 },
        { lng: 99.8920791, lat: 20.0478355 },
        { lng: 99.8920522, lat: 20.0478886 },
        { lng: 99.8919929, lat: 20.0479747 },
        { lng: 99.8919311, lat: 20.0480471 },
        { lng: 99.8919008, lat: 20.0480823 },
        { lng: 99.8918066, lat: 20.0481899 },
        { lng: 99.8917121, lat: 20.0482981 },
        { lng: 99.8916682, lat: 20.0483548 },
        { lng: 99.8916277, lat: 20.0484177 },
        { lng: 99.8915538, lat: 20.0485397 },
        { lng: 99.8914812, lat: 20.0486601 },
        { lng: 99.8913335, lat: 20.048901 },
        { lng: 99.8912989, lat: 20.048965 },
        { lng: 99.8912674, lat: 20.0490311 },
        { lng: 99.891213, lat: 20.0491672 },
        { lng: 99.8911794, lat: 20.0492882 },
        { lng: 99.8911295, lat: 20.0494899 },
        { lng: 99.8911036, lat: 20.049603 },
        { lng: 99.8910957, lat: 20.0496934 },
        { lng: 99.8910806, lat: 20.0498047 },
        { lng: 99.8910759, lat: 20.0499015 },
        { lng: 99.8910751, lat: 20.0501084 },
        { lng: 99.8910777, lat: 20.0503165 },
        { lng: 99.8910776, lat: 20.0504212 },
        { lng: 99.891083, lat: 20.0505258 },
        { lng: 99.8911661, lat: 20.0508231 },
        { lng: 99.8912496, lat: 20.0510115 },
        { lng: 99.8913418, lat: 20.0511728 },
        { lng: 99.8914568, lat: 20.0513753 },
        { lng: 99.8915718, lat: 20.0515803 },
        { lng: 99.8917387, lat: 20.0517806 },
        { lng: 99.8921358, lat: 20.0522538 },
        { lng: 99.8921751, lat: 20.0523178 },
        { lng: 99.8922103, lat: 20.0523818 },
        { lng: 99.8922322, lat: 20.0524206 },
        { lng: 99.8922701, lat: 20.0525097 },
        { lng: 99.8923437, lat: 20.0526852 },
        { lng: 99.8923704, lat: 20.0527851 },
        { lng: 99.8924426, lat: 20.0530252 },
        { lng: 99.892544, lat: 20.0533541 },
        { lng: 99.8926818, lat: 20.0536142 },
        { lng: 99.8927942, lat: 20.0537899 },
        { lng: 99.8929921, lat: 20.0539847 },
        { lng: 99.8930904, lat: 20.0540777 },
        { lng: 99.8932597, lat: 20.0541946 },
        { lng: 99.893452, lat: 20.0543352 },
        { lng: 99.8935988, lat: 20.0544146 },
        { lng: 99.8937482, lat: 20.0544884 },
        { lng: 99.8939365, lat: 20.0545584 },
        { lng: 99.8943517, lat: 20.0546715 },
        { lng: 99.894832, lat: 20.0548677 },
        { lng: 99.8950466, lat: 20.0549622 },
        { lng: 99.8951847, lat: 20.0550159 },
        { lng: 99.8953268, lat: 20.0550632 },
        { lng: 99.8954484, lat: 20.0550785 },
        { lng: 99.8955727, lat: 20.0550912 },
        { lng: 99.8958159, lat: 20.0550706 },
        { lng: 99.8959045, lat: 20.0550686 },
        { lng: 99.8959905, lat: 20.0550704 },
        { lng: 99.8960779, lat: 20.0550879 },
        { lng: 99.8961715, lat: 20.0551356 },
        { lng: 99.8962236, lat: 20.0551707 },
        { lng: 99.8962517, lat: 20.0551902 },
        { lng: 99.8962704, lat: 20.0552135 },
        { lng: 99.8963253, lat: 20.0552935 },
        { lng: 99.8963615, lat: 20.0554031 },
        { lng: 99.8963909, lat: 20.0555114 },
        { lng: 99.8964049, lat: 20.0555788 },
        { lng: 99.8964082, lat: 20.0556462 },
        { lng: 99.8964198, lat: 20.0558554 },
        { lng: 99.896436, lat: 20.0560645 },
        { lng: 99.8964514, lat: 20.0562205 },
        { lng: 99.8964788, lat: 20.0563388 },
        { lng: 99.896543, lat: 20.0564972 },
        { lng: 99.8965736, lat: 20.0565733 },
        { lng: 99.8966296, lat: 20.0566733 },
        { lng: 99.8967472, lat: 20.0568733 },
        { lng: 99.8969916, lat: 20.057318 },
        { lng: 99.8972588, lat: 20.0577513 },
        { lng: 99.8974029, lat: 20.0579564 },
        { lng: 99.8975592, lat: 20.0581589 },
        { lng: 99.8976376, lat: 20.0582523 },
        { lng: 99.8977335, lat: 20.0583456 },
        { lng: 99.8979353, lat: 20.0585122 },
        { lng: 99.8982991, lat: 20.0587598 },
        { lng: 99.8984112, lat: 20.0588311 },
        { lng: 99.8985018, lat: 20.0588697 },
        { lng: 99.8987118, lat: 20.0589607 },
        { lng: 99.8988345, lat: 20.059008 },
        { lng: 99.8989472, lat: 20.0590439 },
        { lng: 99.8991899, lat: 20.0590993 },
        { lng: 99.8993925, lat: 20.059122 },
        { lng: 99.8995896, lat: 20.0591296 },
        { lng: 99.8995937, lat: 20.0590489 },
        { lng: 99.8996017, lat: 20.058957 },
      ]);
    } else if (route === "route2") {
      setPolylinePath([
        { lng: 99.899783, lat: 20.058957 },
        { lng: 99.899691, lat: 20.058958 },
        { lng: 99.899602, lat: 20.058957 },
        { lng: 99.899342, lat: 20.058936 },
        { lng: 99.89925, lat: 20.058923 },
        { lng: 99.89916, lat: 20.058901 },
        { lng: 99.898916, lat: 20.058826 },
        { lng: 99.898817, lat: 20.058791 },
        { lng: 99.898721, lat: 20.058748 },
        { lng: 99.89863, lat: 20.0587 },
        { lng: 99.898524, lat: 20.058626 },
        { lng: 99.898349, lat: 20.058475 },
        { lng: 99.898176, lat: 20.058322 },
        { lng: 99.897987, lat: 20.058143 },
        { lng: 99.897817, lat: 20.057962 },
        { lng: 99.897653, lat: 20.057767 },
        { lng: 99.8975, lat: 20.057562 },
        { lng: 99.897016, lat: 20.056735 },
        { lng: 99.896742, lat: 20.056836 },
        { lng: 99.896699, lat: 20.056765 },
        { lng: 99.896657, lat: 20.056695 },
        { lng: 99.896627, lat: 20.056642 },
        { lng: 99.896597, lat: 20.056587 },
        { lng: 99.896576, lat: 20.056543 },
        { lng: 99.896555, lat: 20.056496 },
        { lng: 99.89649, lat: 20.056338 },
        { lng: 99.896478, lat: 20.056276 },
        { lng: 99.896469, lat: 20.056245 },
        { lng: 99.896464, lat: 20.056213 },
        { lng: 99.896455, lat: 20.056139 },
        { lng: 99.89645, lat: 20.056064 },
        { lng: 99.89644, lat: 20.055961 },
        { lng: 99.896433, lat: 20.055857 },
        { lng: 99.896429, lat: 20.055752 },
        { lng: 99.896421, lat: 20.055646 },
        { lng: 99.896416, lat: 20.055574 },
        { lng: 99.896395, lat: 20.055488 },
        { lng: 99.896375, lat: 20.055403 },
        { lng: 99.896361, lat: 20.055355 },
        { lng: 99.896333, lat: 20.055288 },
        { lng: 99.896287, lat: 20.055215 },
        { lng: 99.896252, lat: 20.055176 },
        { lng: 99.896228, lat: 20.05516 },
        { lng: 99.896179, lat: 20.055124 },
        { lng: 99.896083, lat: 20.055077 },
        { lng: 99.895993, lat: 20.055057 },
        { lng: 99.895892, lat: 20.055056 },
        { lng: 99.895735, lat: 20.055066 },
        { lng: 99.895655, lat: 20.055074 },
        { lng: 99.895573, lat: 20.055078 },
        { lng: 99.895452, lat: 20.055067 },
        { lng: 99.895374, lat: 20.055056 },
        { lng: 99.89533, lat: 20.055051 },
        { lng: 99.895265, lat: 20.055031 },
        { lng: 99.8952, lat: 20.055009 },
        { lng: 99.895136, lat: 20.054987 },
        { lng: 99.895074, lat: 20.054961 },
        { lng: 99.89501, lat: 20.054934 },
        { lng: 99.894948, lat: 20.054906 },
        { lng: 99.894865, lat: 20.054868 },
        { lng: 99.894793, lat: 20.054836 },
        { lng: 99.894575, lat: 20.05475 },
        { lng: 99.89452, lat: 20.054727 },
        { lng: 99.894464, lat: 20.054704 },
        { lng: 99.894354, lat: 20.05466 },
        { lng: 99.894261, lat: 20.054634 },
        { lng: 99.894163, lat: 20.054608 },
        { lng: 99.893941, lat: 20.054546 },
        { lng: 99.893754, lat: 20.054477 },
        { lng: 99.893606, lat: 20.054404 },
        { lng: 99.893459, lat: 20.054324 },
        { lng: 99.893362, lat: 20.054254 },
        { lng: 99.893266, lat: 20.054184 },
        { lng: 99.8931, lat: 20.054071 },
        { lng: 99.893, lat: 20.053979 },
        { lng: 99.892891, lat: 20.053871 },
        { lng: 99.892839, lat: 20.053818 },
        { lng: 99.892805, lat: 20.053785 },
        { lng: 99.89275, lat: 20.053701 },
        { lng: 99.892697, lat: 20.053616 },
        { lng: 99.892581, lat: 20.053398 },
        { lng: 99.892554, lat: 20.053346 },
        { lng: 99.892526, lat: 20.053266 },
        { lng: 99.89249, lat: 20.053146 },
        { lng: 99.892419, lat: 20.052904 },
        { lng: 99.8924, lat: 20.052845 },
        { lng: 99.892384, lat: 20.052784 },
        { lng: 99.892367, lat: 20.052722 },
        { lng: 99.892356, lat: 20.052681 },
        { lng: 99.892297, lat: 20.052543 },
        { lng: 99.892266, lat: 20.052473 },
        { lng: 99.892242, lat: 20.052413 },
        { lng: 99.892197, lat: 20.052331 },
        { lng: 99.892146, lat: 20.052248 },
        { lng: 99.89204, lat: 20.05212 },
        { lng: 99.891986, lat: 20.052055 },
        { lng: 99.891915, lat: 20.051972 },
        { lng: 99.891755, lat: 20.051781 },
        { lng: 99.891675, lat: 20.051686 },
        { lng: 99.891586, lat: 20.051578 },
        { lng: 99.891354, lat: 20.05117 },
        { lng: 99.89127, lat: 20.051021 },
        { lng: 99.891234, lat: 20.050944 },
        { lng: 99.891198, lat: 20.050866 },
        { lng: 99.89118, lat: 20.050824 },
        { lng: 99.891168, lat: 20.050781 },
        { lng: 99.891144, lat: 20.050696 },
        { lng: 99.891117, lat: 20.050611 },
        { lng: 99.891094, lat: 20.050526 },
        { lng: 99.891088, lat: 20.05042 },
        { lng: 99.891087, lat: 20.050314 },
        { lng: 99.891086, lat: 20.050109 },
        { lng: 99.891085, lat: 20.049902 },
        { lng: 99.891089, lat: 20.049805 },
        { lng: 99.891104, lat: 20.049695 },
        { lng: 99.891112, lat: 20.049604 },
        { lng: 99.891136, lat: 20.04949 },
        { lng: 99.891161, lat: 20.049391 },
        { lng: 99.891187, lat: 20.049291 },
        { lng: 99.891221, lat: 20.049168 },
        { lng: 99.891276, lat: 20.049032 },
        { lng: 99.89131, lat: 20.048963 },
        { lng: 99.891338, lat: 20.048909 },
        { lng: 99.891359, lat: 20.048877 },
        { lng: 99.891436, lat: 20.048887 },
        { lng: 99.891497, lat: 20.048883 },
        { lng: 99.891625, lat: 20.048834 },
        { lng: 99.891796, lat: 20.048764 },
        { lng: 99.892251, lat: 20.048559 },
        { lng: 99.892642, lat: 20.048384 },
        { lng: 99.892947, lat: 20.048246 },
        { lng: 99.893031, lat: 20.0482093 },
        { lng: 99.8930095, lat: 20.048104 },
        { lng: 99.8929886, lat: 20.0480133 },
        { lng: 99.892951, lat: 20.047862 },
        { lng: 99.893179, lat: 20.047481 },
        { lng: 99.893178, lat: 20.047227 },
        { lng: 99.893052, lat: 20.047226 },
        { lng: 99.892972, lat: 20.047481 },
        { lng: 99.892935, lat: 20.047868 },
        { lng: 99.8929861, lat: 20.0480604 },
        { lng: 99.8929956, lat: 20.0481048 },
        { lng: 99.8930045, lat: 20.048154 },
        { lng: 99.89301, lat: 20.048202 },
        { lng: 99.892982, lat: 20.048214 },
        { lng: 99.892933, lat: 20.048235 },
        { lng: 99.892639, lat: 20.048374 },
        { lng: 99.892213, lat: 20.048565 },
        { lng: 99.891793, lat: 20.048756 },
        { lng: 99.891622, lat: 20.048825 },
        { lng: 99.891496, lat: 20.048873 },
        { lng: 99.891437, lat: 20.048878 },
        { lng: 99.891364, lat: 20.04887 },
        { lng: 99.89151, lat: 20.048633 },
        { lng: 99.891581, lat: 20.048513 },
        { lng: 99.891616, lat: 20.048454 },
        { lng: 99.891674, lat: 20.048364 },
        { lng: 99.891708, lat: 20.04832 },
        { lng: 99.891743, lat: 20.048277 },
        { lng: 99.891836, lat: 20.048171 },
        { lng: 99.891939, lat: 20.048054 },
        { lng: 99.892002, lat: 20.047981 },
        { lng: 99.892059, lat: 20.04789 },
        { lng: 99.892085, lat: 20.04784 },
        { lng: 99.892112, lat: 20.047789 },
        { lng: 99.892157, lat: 20.047631 },
        { lng: 99.892178, lat: 20.047509 },
        { lng: 99.892185, lat: 20.047409 },
        { lng: 99.892195, lat: 20.047311 },
        { lng: 99.89217, lat: 20.04706 },
        { lng: 99.892108, lat: 20.046836 },
        { lng: 99.892065, lat: 20.046741 },
        { lng: 99.892004, lat: 20.046646 },
        { lng: 99.891914, lat: 20.046494 },
        { lng: 99.891791, lat: 20.046232 },
        { lng: 99.891719, lat: 20.046075 },
        { lng: 99.89168, lat: 20.045994 },
        { lng: 99.891632, lat: 20.045915 },
        { lng: 99.891559, lat: 20.045774 },
        { lng: 99.891486, lat: 20.045634 },
        { lng: 99.891414, lat: 20.045499 },
        { lng: 99.891388, lat: 20.045449 },
        { lng: 99.891331, lat: 20.045313 },
        { lng: 99.891315, lat: 20.045214 },
        { lng: 99.89131, lat: 20.04514 },
        { lng: 99.891304, lat: 20.044912 },
        { lng: 99.891312, lat: 20.04476 },
        { lng: 99.891345, lat: 20.044594 },
        { lng: 99.891434, lat: 20.044403 },
        { lng: 99.891513, lat: 20.044234 },
        { lng: 99.891618, lat: 20.044224 },
        { lng: 99.891826, lat: 20.044223 },
        { lng: 99.89196, lat: 20.044221 },
        { lng: 99.892034, lat: 20.04422 },
        { lng: 99.892627, lat: 20.044132 },
        { lng: 99.892855, lat: 20.044113 },
        { lng: 99.892883, lat: 20.04411 },
        { lng: 99.892982, lat: 20.044091 },
        { lng: 99.893046, lat: 20.044068 },
        { lng: 99.893205, lat: 20.043997 },
        { lng: 99.8933438, lat: 20.043937 },
        { lng: 99.8938202, lat: 20.0437167 },
        { lng: 99.8939641, lat: 20.0436813 },
        { lng: 99.8938202, lat: 20.0437167 },
        { lng: 99.8934619, lat: 20.0438692 },
        { lng: 99.8934739, lat: 20.0439223 },
        { lng: 99.8934771, lat: 20.0439663 },
        { lng: 99.893493, lat: 20.044039 },
        { lng: 99.8935179, lat: 20.0440711 },
        { lng: 99.8935563, lat: 20.0440843 },
        { lng: 99.8937393, lat: 20.0440703 },
        { lng: 99.8938787, lat: 20.0440708 },
        { lng: 99.893951, lat: 20.0440259 },
        { lng: 99.8939657, lat: 20.0439008 },
        { lng: 99.8939561, lat: 20.0438113 },
        { lng: 99.8939641, lat: 20.0436813 },
        { lng: 99.8938202, lat: 20.0437167 },
        { lng: 99.8934619, lat: 20.0438692 },
        { lng: 99.893041, lat: 20.044057 },
        { lng: 99.89298, lat: 20.044078 },
        { lng: 99.892917, lat: 20.044091 },
        { lng: 99.892854, lat: 20.044099 },
        { lng: 99.892623, lat: 20.04412 },
        { lng: 99.892329, lat: 20.044164 },
        { lng: 99.892034, lat: 20.044209 },
        { lng: 99.891825, lat: 20.04421 },
        { lng: 99.891618, lat: 20.044211 },
        { lng: 99.8915175, lat: 20.0442187 },
        { lng: 99.8915537, lat: 20.0441256 },
        { lng: 99.8916625, lat: 20.0438714 },
        { lng: 99.891725, lat: 20.0436109 },
        { lng: 99.8918196, lat: 20.0434373 },
        { lng: 99.8919435, lat: 20.0432104 },
        { lng: 99.8920526, lat: 20.0428172 },
        { lng: 99.8921326, lat: 20.0425935 },
        { lng: 99.8922408, lat: 20.0423547 },
        { lng: 99.892362, lat: 20.0422131 },
        { lng: 99.8924859, lat: 20.0420678 },
        { lng: 99.8925836, lat: 20.0419842 },
        { lng: 99.892684, lat: 20.0419145 },
        { lng: 99.892817, lat: 20.0418553 },
        { lng: 99.8929863, lat: 20.0417836 },
        { lng: 99.8931625, lat: 20.0417522 },
        { lng: 99.893217, lat: 20.0416053 },
        { lng: 99.8937912, lat: 20.041517 },
        { lng: 99.8939765, lat: 20.0414577 },
        { lng: 99.894118, lat: 20.0413739 },
        { lng: 99.8942528, lat: 20.0413682 },
        { lng: 99.8943366, lat: 20.0413492 },
        { lng: 99.8945177, lat: 20.0412494 },
        { lng: 99.8945115, lat: 20.0412362 },
        { lng: 99.8943324, lat: 20.0413332 },
        { lng: 99.8942515, lat: 20.0413545 },
        { lng: 99.8941135, lat: 20.0413608 },
        { lng: 99.8939702, lat: 20.0414464 },
        { lng: 99.8937876, lat: 20.0415028 },
        { lng: 99.8932107, lat: 20.0415919 },
        { lng: 99.8931528, lat: 20.0417402 },
        { lng: 99.8929816, lat: 20.0417712 },
        { lng: 99.8926796, lat: 20.0419019 },
        { lng: 99.892575, lat: 20.0419755 },
        { lng: 99.892477, lat: 20.0420591 },
        { lng: 99.8923516, lat: 20.0422052 },
        { lng: 99.8922288, lat: 20.0423481 },
        { lng: 99.8921191, lat: 20.0425886 },
        { lng: 99.892039, lat: 20.0428152 },
        { lng: 99.8919283, lat: 20.0432081 },
        { lng: 99.8918096, lat: 20.0434325 },
        { lng: 99.8917009, lat: 20.0436355 },
        { lng: 99.8915225, lat: 20.0438631 },
        { lng: 99.891381, lat: 20.044189 },
        { lng: 99.891226, lat: 20.044557 },
        { lng: 99.891188, lat: 20.044738 },
        { lng: 99.891178, lat: 20.044978 },
        { lng: 99.891185, lat: 20.045099 },
        { lng: 99.891232, lat: 20.045295 },
        { lng: 99.891277, lat: 20.045439 },
        { lng: 99.891321, lat: 20.045568 },
        { lng: 99.891348, lat: 20.04565 },
        { lng: 99.891387, lat: 20.045732 },
        { lng: 99.8915, lat: 20.045965 },
        { lng: 99.891608, lat: 20.046094 },
        { lng: 99.891717, lat: 20.046233 },
        { lng: 99.891907, lat: 20.046498 },
        { lng: 99.892056, lat: 20.046743 },
        { lng: 99.892067, lat: 20.046764 },
        { lng: 99.8921, lat: 20.046838 },
        { lng: 99.892162, lat: 20.047061 },
        { lng: 99.892184, lat: 20.047312 },
        { lng: 99.892174, lat: 20.047408 },
        { lng: 99.892167, lat: 20.047509 },
        { lng: 99.892146, lat: 20.047629 },
        { lng: 99.892105, lat: 20.047786 },
        { lng: 99.892079, lat: 20.047836 },
        { lng: 99.892052, lat: 20.047889 },
        { lng: 99.891993, lat: 20.047975 },
        { lng: 99.891931, lat: 20.048047 },
        { lng: 99.891901, lat: 20.048082 },
        { lng: 99.891807, lat: 20.04819 },
        { lng: 99.891712, lat: 20.048298 },
        { lng: 99.891668, lat: 20.048355 },
        { lng: 99.891628, lat: 20.048418 },
        { lng: 99.891554, lat: 20.04854 },
        { lng: 99.891481, lat: 20.04866 },
        { lng: 99.891334, lat: 20.048901 },
        { lng: 99.891299, lat: 20.048965 },
        { lng: 99.891267, lat: 20.049031 },
        { lng: 99.891213, lat: 20.049167 },
        { lng: 99.891179, lat: 20.049288 },
        { lng: 99.89113, lat: 20.04949 },
        { lng: 99.891104, lat: 20.049603 },
        { lng: 99.891096, lat: 20.049693 },
        { lng: 99.891081, lat: 20.049805 },
        { lng: 99.891076, lat: 20.049902 },
        { lng: 99.891075, lat: 20.050108 },
        { lng: 99.891078, lat: 20.050316 },
        { lng: 99.891078, lat: 20.050421 },
        { lng: 99.891083, lat: 20.050526 },
        { lng: 99.891166, lat: 20.050823 },
        { lng: 99.89125, lat: 20.051012 },
        { lng: 99.891342, lat: 20.051173 },
        { lng: 99.891457, lat: 20.051375 },
        { lng: 99.891572, lat: 20.05158 },
        { lng: 99.891739, lat: 20.051781 },
        { lng: 99.892136, lat: 20.052254 },
        { lng: 99.892175, lat: 20.052318 },
        { lng: 99.89221, lat: 20.052382 },
        { lng: 99.892232, lat: 20.052421 },
        { lng: 99.89227, lat: 20.05251 },
        { lng: 99.892344, lat: 20.052685 },
        { lng: 99.89237, lat: 20.052785 },
        { lng: 99.892443, lat: 20.053025 },
        { lng: 99.892544, lat: 20.053354 },
        { lng: 99.892682, lat: 20.053614 },
        { lng: 99.892794, lat: 20.05379 },
        { lng: 99.892992, lat: 20.053985 },
        { lng: 99.89309, lat: 20.054078 },
        { lng: 99.89326, lat: 20.054195 },
        { lng: 99.893452, lat: 20.054335 },
        { lng: 99.893599, lat: 20.054415 },
        { lng: 99.893748, lat: 20.054488 },
        { lng: 99.893936, lat: 20.054558 },
        { lng: 99.894352, lat: 20.054672 },
        { lng: 99.894832, lat: 20.054868 },
        { lng: 99.895047, lat: 20.054962 },
        { lng: 99.895185, lat: 20.055016 },
        { lng: 99.895327, lat: 20.055063 },
        { lng: 99.895448, lat: 20.055078 },
        { lng: 99.895573, lat: 20.055091 },
        { lng: 99.895816, lat: 20.055071 },
        { lng: 99.895904, lat: 20.055069 },
        { lng: 99.89599, lat: 20.05507 },
        { lng: 99.896078, lat: 20.055088 },
        { lng: 99.896172, lat: 20.055136 },
        { lng: 99.896224, lat: 20.055171 },
        { lng: 99.896252, lat: 20.05519 },
        { lng: 99.89627, lat: 20.055214 },
        { lng: 99.896325, lat: 20.055294 },
        { lng: 99.896362, lat: 20.055403 },
        { lng: 99.896391, lat: 20.055511 },
        { lng: 99.896405, lat: 20.055579 },
        { lng: 99.896408, lat: 20.055646 },
        { lng: 99.89642, lat: 20.055855 },
        { lng: 99.896436, lat: 20.056064 },
        { lng: 99.896451, lat: 20.05622 },
        { lng: 99.896479, lat: 20.056339 },
        { lng: 99.896543, lat: 20.056497 },
        { lng: 99.896574, lat: 20.056573 },
        { lng: 99.89663, lat: 20.056673 },
        { lng: 99.896747, lat: 20.056873 },
        { lng: 99.896992, lat: 20.057318 },
        { lng: 99.897259, lat: 20.057751 },
        { lng: 99.897403, lat: 20.057956 },
        { lng: 99.897559, lat: 20.058159 },
        { lng: 99.897638, lat: 20.058252 },
        { lng: 99.897734, lat: 20.058346 },
        { lng: 99.897935, lat: 20.058512 },
        { lng: 99.898299, lat: 20.05876 },
        { lng: 99.898411, lat: 20.058831 },
        { lng: 99.898502, lat: 20.05887 },
        { lng: 99.898712, lat: 20.058961 },
        { lng: 99.898834, lat: 20.059008 },
        { lng: 99.898947, lat: 20.059044 },
        { lng: 99.89919, lat: 20.059099 },
        { lng: 99.899392, lat: 20.059122 },
        { lng: 99.89959, lat: 20.05913 },
        { lng: 99.899594, lat: 20.059049 },
        { lng: 99.899602, lat: 20.058957 }
      ]);  } else {
        setPolylinePath([]);
      }
    }, []);
  /////////////////////////////////////////////////////////

  /////////////// test polyline path selected route ///////
  useEffect(() => {
    updatePolylinePath(selectedRoute || "");
  }, [selectedRoute, updatePolylinePath]);
  /////////////////////////////////////////////////////////

  // Keep this useMemo for other markers ตำแหน่งรถเจม
  const markers = useMemo(() => {

    if (!data) return null;
    let filteredData = Object.entries(data);
    if (selectedRoute === 'route1') {
      filteredData = filteredData.filter(([key]) => key === "01" || key === "02" || key === "03" || key === "04" || key === "05" || key === "07" || key === "09" || key === "10" || key === "11" || key === "12" || key === "13" || key === "14" || key === "15");
    }

    if (selectedRoute === 'route2') {
      filteredData = filteredData.filter(([key]) => key === "06" || key === "08" || key === "16");
    }

    return filteredData.map(([key, value]) => {
      if (value && value.position) {
        const [lat, lng] = value.position.split(",").map(Number);
        if (!isNaN(lat) && !isNaN(lng)) {
          return (
            <React.Fragment key={key}>
              <Marker
                position={{ lat, lng }}
                title={`รถเจมหมายเลข: ${key}`}
                onClick={() => handleMarkerClick(key, value)}
                icon={{
                  url: busIcon,
                  scaledSize: new window.google.maps.Size(64, 36), // Adjusted size as needed
                  origin: new window.google.maps.Point(0, 0), // The origin point of the icon image (usually top-left)
                  anchor: new window.google.maps.Point(32, 18), // The anchor point of the icon image (center bottom for 64x36)
                  rotation: value.direction, // Set the rotation based on direction
                }}
              />
              {selectedMarker && selectedMarker.key === key && (
                <InfoWindow
                  position={{ lat: lat, lng: lng }}
                  onCloseClick={handleInfoWindowClose}
                  headerContent={`รถเจมหมายเลข ${key}`}
                >
                  <div>
                    <p>ความเร็ว: {value.speed} km/h</p>
                  </div>
                </InfoWindow>
              )}
            </React.Fragment>
          );
        }
      }
      return null;
    });
  }, [data, handleMarkerClick, selectedMarker, handleInfoWindowClose, selectedRoute]);



  // station markers mock ==================================================================================================
  const stationmarkers1 = {
    status: "ok",
    data: {
      "1": { position: "20.058752, 99.898396" },
      "2": { position: "20.057039, 99.896930" },
      "3": { position: "20.054683, 99.894515" },
      "4": { position: "20.052544, 99.892316" },
      "5": { position: "20.050816843021277, 99.89121969349162" },
      "6": { position: "20.049137353450433, 99.891250485570452" },
      "7": { position: "20.048193, 99.893221" },
      "8": { position: "20.047264832318994, 99.89314563095694" },
      "9": { position: "20.045503, 99.891442" },
      "10": { position: "20.043881444753783, 99.89348617576454" },
      "11": { position: "20.043919609786567, 99.89490923095694" },
      "12": { position: "20.043311336533844, 99.89529707515575" },
      "13": { position: "20.043845538331563, 99.8934754469289" },
      "14": { position: "20.045659393241642, 99.89133178188165" },
      "15": { position: "20.049391118491396, 99.89111283095696" },
      "16": { position: "20.05083048583872, 99.89115650886787" },
      "17": { position: "20.052689636083315, 99.89234180090831" },
      "18": { position: "20.05473222049373, 99.89448019896511" },
      "19": { position: "20.056897650552507, 99.89711855304603" },
      "20": { position: "20.05806378447924, 99.89787541746388" },
      "21": { position: "20.058966957817436, 99.8995173298247" }
    },
  };
  const urlMarker1 = "/station1.png";
  
  const stationmarkers2 = {
    status: "ok",
    data: {
      "1": { position: "20.058752, 99.898396" },
      "2": { position: "20.057039, 99.896930" },
      "3": { position: "20.054683, 99.894515" },
      "4": { position: "20.052544, 99.892316" },
      "5": { position: "20.050816843021277, 99.89121969349162" },
      "6": { position: "20.049137353450433, 99.891250485570452" },
      "7": { position: "20.048193, 99.893221" },
      "8": { position: "20.047264832318994, 99.89314563095694" },
      "9": { position: "20.045503, 99.891442" },
      "10": { position: "20.043881444753783, 99.89348617576454" },
      "11": { position: "20.043845538331563, 99.8934754469289" },
      "12": { position: "20.041244, 99.894427" },
      "13": { position: "20.045659393241642, 99.89133178188165" },
      "14": { position: "20.049391118491396, 99.89111283095696" },
      "15": { position: "20.05083048583872, 99.89115650886787" },
      "16": { position: "20.052689636083315, 99.89234180090831" },
      "17": { position: "20.05473222049373, 99.89448019896511" },
      "18": { position: "20.056897650552507, 99.89711855304603" },
      "19": { position: "20.05806378447924, 99.89787541746388" },
      "20": { position: "20.058966957817436, 99.8995173298247" }
    },
  };
  const urlMarker2 = "/station2.png";

  // ==================================================================================================

  // interface SelectedMarker ==================================================================================================
  interface SelectedstationMarker {
    key: string;
    value: TrackerstatioData;
  }
  interface TrackerstatioData {
    position: string;
  }
  // ==================================================================================================

  // set selected station markers=================================================================================================
  const [selectedstationMarker, setselectedstationMarker] =
    useState<SelectedstationMarker | null>(null);
  // ==================================================================================================


  return (
    <>
      <APIProvider apiKey={MAPAPIKEY} libraries={["places"]}>
        <Map
          style={{ width: "100%", height: "100vh" }}
          defaultZoom={15}
          defaultCenter={center}
          mapId={MAPID}
          gestureHandling={"greedy"}
          disableDefaultUI={true}
        />
        {/* markerรถเจม */}
        {markers}

        {/* marker ผู้ใช้งาน */}
        {userMarker}

        {/* station markers */}
        {selectedRoute === "route1" ?
         <StationMarker
          position={stationmarkers1}
          selectedMarker={selectedstationMarker}
          setSelectedMarker={setselectedstationMarker}
          setCenter={setCenter} 
          urlMarker={urlMarker1}        />:
        <StationMarker
          position={stationmarkers2}
          selectedMarker={selectedstationMarker}
          setSelectedMarker={setselectedstationMarker}
          setCenter={setCenter} 
          urlMarker={urlMarker2}        />}

        <PolylineComponent
          path={polylinePath}
          color={selectedRoute === "route1" ? "#8b090c" : "#e2b644"} 
        />
      </APIProvider>
    </>
  );
};

export default MapComponant;
